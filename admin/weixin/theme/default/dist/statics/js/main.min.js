function infinite_scroll(e,t,n,i,a){return loading||i.page>total_page?void $(".content-inner").css({paddingBottom:"0"}):(loading=!0,void handleAjax.handle(t,{tmpl_pre_dir:"inc",page:i.page},"html").done(function(t){var o=$('<div id="tmpHTML"></div>').html(t),s=o.find(n),c=$(s).html();$(c).find(".total_page").remove(),i.page++,loading=!1,$(e).find(n).append(c),$.refreshScroller(),null!=a&&a(),$(".lazyload").picLazyLoad()}).fail(function(e){$.toast(e)}))}function pull_refresh(e,t,n,i,a){var o=!1;console.log(t),o||(o=!0,handleAjax.handle(t,"","html").done(function(t){refreshing=!1;var s=$('<div id="tmpHTML"></div>').html(t),c=s.find(n),l=$(e).find(n),r=$(c).html();value=r.replace(/\s+/g,"");var t=$(t).find(".content").html(),d=c.find("input[name='total_page']").val();o=!1,i.page=2,i.total_page=d,setTimeout(function(){l.addClass("animated fadeInUp").html(value.length>0?r:'<div style="text-align:center;color:#999;font-size:0.75rem;">暂无数据</div>'),setTimeout(function(){l.removeClass("fadeInUp")},1e3),$.pullToRefreshDone(".pull-to-refresh-content"),$(".pull-to-refcontainerresh-layer").css({visibility:"visible"}),page=2,$(".lazyload").picLazyLoad(),"function"==typeof a&&a.call(this)},300)}).fail(function(e){$.toast(e)}))}$(document).on("pageInit","#page-course-detail",function(e,t,n){var i=new Vue({el:"#vscope-course_detail",data:{is_show_all_count:!1,is_show_err_pop:!1,is_show_err:!1,is_show_more_bief:!1,is_hide_video_type:!1,is_hide_change_audio:!1,show_err_text:"",is_audio:!1,no_video:!1,canot_view:!1,is_vip:0,vip:!1,video_url:!1,sound_url:!1,current_time:0,img:!1,id:0,course_content:course_content,is_show_video_bg:!1,player_position:0},mounted:function(){this.reset_videobox(),this.reSetConTop(),this.has_more_bief(),this.init_vedio()},methods:{play:function(){playerInit.play()},has_more_bief:function(){var e=$(".bief-inner").height(),t=$(".bief-con").height();e>t?$(".j-show-more-bief").show():$(".j-show-more-bief").hide()},reset_videobox:function(){var e=$(window).width(),t=9*$(window).width()/16;$(".video-box").css({width:e,height:t})},reSetConTop:function(){$(".pop-up").css("top",.5625*$(window).width()+$(".detail-head").height()),$.refreshScroller()},init_vedio:function(){this.runPlayer(course.data)},change_course:function(e,t){handleAjax.handle(APP_ROOT+"/weixin/index.php?ctl=course&act=detail",{id:e},"",1).done(function(n){i.is_audio=!1,i.player_position=0,i.course_content=n.data.content,i.runPlayer(n.data),$('.all-vedio-item[rel="'+e+'"]').addClass("active").siblings().removeClass("active"),$(t.target).addClass("active").siblings().removeClass("active")}).fail(function(e){$.toast(e)})},change_audio:function(e){i.is_audio=!i.is_audio,i.runPlayer(!1)&&(this.is_audio?$.toast("已切换音频模式"):$.toast("已切换视频模式"))},runPlayer:function(e){if(0!=e){this.id=0,this.is_vip=0,this.current_time=0,this.duration_time=0,this.vip=!1,this.video_url=!1,this.sound_url=!1,this.img=!1,this.no_video=!1,this.is_show_err_pop=!1,this.no_video=!1,this.is_show_err=!1,this.is_hide_change_audio=!1,this.show_err_text="",this.no_video=!1,this.canot_view=!1;for(var t in e)void 0!=this[t]&&(this[t]=e[t])}var n=this.is_audio?this.sound_url:this.video_url,a=this.current_time;if(this.is_hide_video_type=!this.is_vip,this.is_vip>0&&!this.vip)this.is_show_err_pop=!0,this.canot_view=!0,this.is_show_video_bg=!1;else{if(n)return this.sound_url||(this.is_hide_change_audio=!1),null==playerInit.getState()?(playerInit.setup({width:$(window).width(),height:9*$(window).width()/16,image:this.img,stretching:"fill",controls:1,primary:"html5",autostart:!1,file:n,position:this.current_time,events:{onReady:this.onReady,onPlay:this.onPlay,onPause:this.onPause}}),playerInit.on("time",function(e){e.position-i.current_time>10&&i.checkCurrentTime(e.position),i.duration_time=e.duration_time,e.position>i.player_position?i.player_position=e.position:i.player_position=i.player_position}),playerInit.on("play",function(e){i.player_position>0?i.player_position<playerInit.getDuration()&&playerInit.seek(i.player_position):a<playerInit.getDuration()&&playerInit.seek(a)})):playerInit.load([{file:n,image:this.img}]),this.is_show_video_bg=!0,!0;this.no_video=!0,this.is_hide_change_audio=!0,this.is_show_video_bg=!1,console.log("no file")}return!1},checkCurrentTime:function(e){i.current_time=e,$.post(APP_ROOT+"/mapi/index.php?ctl=course&act=check&itype=wx",{id:i.id,current_time:i.current_time})},onReady:function(){console.log("onPlay"),i.is_show_all_count=!1,this.is_vip?i.is_hide_video_type=!1:i.is_hide_video_type=!0;var e=$("#video-top").find("video");e.attr({"x5-video-player-type":"h5","x5-video-player-fullscreen":"true"}),e.attr("playsinline",!0)},onPlay:function(){console.log("onPlay"),i.checkCurrentTime(playerInit.getPosition()),i.is_show_all_count=!1,i.is_hide_video_type=!0,i.is_show_video_bg=!1},onPause:function(){console.log("onPause"),i.checkCurrentTime(playerInit.getPosition()),void 0!=this.sound_url&&(this.is_hide_change_audio=!1),i.is_hide_video_type=!1,i.is_show_video_bg=!0},show_more_bief:function(){i.is_show_more_bief=!i.is_show_more_bief},show_all_count:function(){i.is_show_all_count=!0},hide_all_count:function(){i.is_show_all_count=!1},cannel_err_pop:function(){i.is_show_err_pop=!1}}});$(window).resize(function(){i.reset_videobox()})}),$(document).on("pageInit","#page-course-qi_list, #page-course-yu_list",function(e,t,n){function i(){switch("page-course-yu_list"==t&&(a="yu_list"),t){case"page-course-yu_list":a="yu_list";break;case"page-course-qi_list":a="qi_list"}new_paramet=paramet.list_type?"&list_type="+paramet.list_type:"",ajax_url=APP_ROOT+"/weixin/index.php?ctl=course&act="+a+new_paramet,console.log(ajax_url)}var a;i();var o=new Vue({el:"#vscope-paging",data:{total_page:total_page,page:page}});$(n).on("infinite",function(e){infinite_scroll(n,APP_ROOT+"/weixin/index.php?ctl=course&act="+a+new_paramet,".course-list",o)}),$(n).find(".pull-to-refresh-content").on("refresh",function(e){pull_refresh(n,ajax_url,".course-list",o)})}),$(document).on("pageInit","#page-course-index, #page-course-qi_list",function(e,t,n){$("#form-search").submit(function(){location.href=APP_ROOT+"/weixin/index.php?ctl=course&act=search&search="+$(this).find("input[name='search']").val()}),$(".searchbar-cancel").on("click",function(){$("input[name='search']").val("")})}),$(document).on("pageInit","#page-course-yu_list, #page-course-qi_list",function(e,t,n){$("#form-search").submit(function(){location.href=APP_ROOT+"/weixin/index.php?ctl=course&act=search&search="+$(this).find("input[name='search']").val()}),$(".searchbar-cancel").on("click",function(){$("input[name='search']").val("")})}),$(document).on("pageInit","#page-course-search",function(e,t,n){empty($("input[name='search']").val())||$(".searchbar").addClass("searchbar-active");var i=!1;$("#form-search").submit(function(){var e=$(this),t=e.find("input[name='search']"),a=t.val();if(!i){if(empty(a))return;i=!0,t.blur(),handleAjax.handle(APP_ROOT+"/weixin/index.php?ctl=course&act=search",{search:a},"html").done(function(e){i=!1;var t=$('<div id="tmpHTML"></div>').html(e),a=t.find(".course-item-list"),o=$(a).html();$(n).find(".course-item-list").addClass("animated fadeIn").html(o),setTimeout(function(){$(n).find(".course-item-list").removeClass("fadeIn")},1e3),$(".lazyload").picLazyLoad()}).fail(function(e){$.toast(e)})}}),$("input[name='search']").blur(function(){empty($(this).val())||$(".searchbar").addClass("searchbar-active")}),$(".searchbar-cancel").on("click",function(){$("input[name='search']").val("")})}),$(document).on("pageInit","#page-course-vip",function(e,t,n){var i=new Vue({el:"#vscope-course_vip",data:data,methods:{list:function(e){console.log(e)},wx_pay:function(){var e={pay_id:this.pay_id,vip_id:this.vip_id,pid:this.pid};handleAjax.handle(APP_ROOT+"/weixin/index.php?ctl=pay&act=pay",e,"",1).done(function(e){console.log(e),location.href=e.jsApiParameters.notify_url}).fail(function(e){$.toast(e)})},callpay:function(){var e=this;"undefined"==typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",e.jsApiCall,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",e.jsApiCall),document.attachEvent("onWeixinJSBridgeReady",e.jsApiCall)):e.jsApiCall()},callpay_1:function(){wx.chooseWXPay(i.jsApiParameters)},jsApiCall:function(){jsApiParameters=JSON.parse(i.jsApiParameters),WeixinJSBridge.invoke("getBrandWCPayRequest",jsApiParameters,function(e){"get_brand_wcpay_request:fail"==e.err_msg&&$.alert("支付失败"),"get_brand_wcpay_request:cancel "==e.err_msg&&$.alert("支付取消"),"get_brand_wcpay_request:ok"==e.err_msg&&($.toast("支付成功",1e3),setTimeout(function(){location.href=APP_ROOT+"/weixin/index.php?ctl=course&act=detail&pid="},1e3))})}}});$(".J-vip-price").on("click",function(){var e=$(this);$(this).addClass("active").siblings().removeClass("active"),i.vip_id=e.attr("data-id"),i.cost=e.attr("data-cost"),i.name=e.attr("data-name")})}),$(document).on("pageInit","#page-course-vip_exchange",function(e,t,n){new Vue({el:"#vscope-vip_exchange",data:{code:""},methods:{submit:function(){handleAjax.handle(APP_ROOT+"/weixin/index.php?ctl=course&act=vip_exchange",{code:this.code}).done(function(e){$.toast(e,1e3),setTimeout(function(){history.back()},1e3)}).fail(function(e){$.toast(e)})}}})}),$(document).on("pageInit","#page-date-index, #page-date-detail",function(e,t,n){var i;i=$(".character-bief span").height()>=87;var a=new Vue({el:"#vscope-meet",data:{name:"",mobile:"",verify:"",date_id:"",date_text:"",is_disabled:!1,code_lefttime:0,code_timeer:null,is_open_date:!1,is_more_bief:!1,has_wanna:has_wanna,wanna_count:wanna_count,has_more_character_bief:i},methods:{select_date:function(e){a.date_text=$(e.target).find("option").not(function(){return!this.selected}).text()},show_more_bief:function(){a.is_more_bief=!a.is_more_bief},open_date:function(e){a.date_id=e,a.is_open_date=!0},cancel_date:function(){a.is_open_date=!1},check:function(){var e=this;return a.name=$.emoji2Str(a.name),"page-date-detail"==t?empty(e.name)?($.toast("姓名不能为空"),!1):empty(e.mobile)?($.toast("手机号不能为空"),!1):$.checkMobilePhone(e.mobile)?!empty(e.verify)||($.toast("请填写验证码"),!1):($.toast("请输入有效的手机号"),!1):empty(e.name)?($.toast("姓名不能为空"),!1):empty(e.mobile)?($.toast("手机号不能为空"),!1):$.checkMobilePhone(e.mobile)?empty(e.verify)?($.toast("请填写验证码"),!1):!empty(e.date_id)||($.toast("请选择分类"),!1):($.toast("请输入有效的手机号"),!1)},submit:function(){if(self=this,!self.check())return!1;var e={name:self.name,mobile:self.mobile,verify:self.verify,date_id:self.date_id};handleAjax.handle(APP_ROOT+"/weixin/index.php?ctl=date&act=date",e).done(function(e){$.toast(e,1e3),setTimeout(function(){a.is_open_date=!1},1e3)}).fail(function(e){$.toast(e)})},send_code:function(e){var t=this;if(t.is_disabled)return!1;var n=($("#j-send-code"),new Object);n.mobile=t.mobile,$.ajax({url:APP_ROOT+"/weixin/index.php?ctl=date&act=send_mobile_verify&itype=wx&post_type=json",data:n,type:"POST",dataType:"json",success:function(e){return 1==e.status?(countdown=60,a.code_lefttime=60,t.code_lefttime_fuc("#j-send-code",t.code_lefttime),!1):($.toast(e.error),!1)}})},code_lefttime_fuc:function(e,t){var n=this;clearTimeout(n.code_timeer),$(e).css("color","#999"),$(e).html("重新发送 "+t),t--,t>0?($(e).attr("disabled","disabled"),n.is_disabled=!0,a.code_timeer=setTimeout(function(){n.code_lefttime_fuc(e,t)},1e3)):(t=60,n.is_disabled=!1,$(e).removeAttr("disabled"),$(e).html("发送验证码"))},wanna:function(e){self=this,handleAjax.handle(APP_ROOT+"/weixin/index.php?ctl=date&act=wanna",{date_id:self.date_id},"",1).done(function(e){e.has_wanna?(a.has_wanna=1,a.wanna_count=a.wanna_count+1):(a.has_wanna=0,a.wanna_count=a.wanna_count-1)}).fail(function(e){$.toast(e)})}}})}),$(document).on("pageInit","#page-course-index",function(e,t,n){$(".go-top").on("click",function(){$(".content").scrollTop(0)}),$(".content").scroll(function(){var e=$(".content").scrollTop();0==e?$(".go-top").css("display","none"):$(".go-top").css("display","block")});new Swiper(".swiper-container",{autoplay:5e3,pagination:".swiper-pagination"})}),$(document).on("pageInit","#page-pay-wx_jspay",function(e,t,n){new Vue({el:"#vscope-wx_pay",data:"",methods:{wx_pay:function(){self=this,"V4"==self.type?self.callpay_1():self.callpay()},callpay:function(){var e=this;"undefined"==typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",e.jsApiCall,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",e.jsApiCall),document.attachEvent("onWeixinJSBridgeReady",e.jsApiCall)):e.jsApiCall()},callpay_1:function(){wx.chooseWXPay(jsApiParameters)},jsApiCall:function(){WeixinJSBridge.invoke("getBrandWCPayRequest",jsApiParameters,function(e){"get_brand_wcpay_request:fail"==e.err_msg&&$.alert("支付失败"),"get_brand_wcpay_request:cancel "==e.err_msg&&$.alert("支付取消"),"get_brand_wcpay_request:ok"==e.err_msg&&($.toast("支付成功",1e3),setTimeout(function(){location.href=APP_ROOT+"/weixin/index.php?ctl=course&act=detail&pid="+pid},1e3))})}}})}),$(document).on("pageInit","#page-question-detail",function(e,t,n){var i=new Vue({el:"#vscope-question_detail",data:{id:"",answer:"",praise_count:praise_count},methods:{del_question:function(e){$.confirm("确认删除您的该提问？",function(){handleAjax.handle(APP_ROOT+"/weixin/index.php?ctl=question&act=delete",{id:e}).done(function(e){$.toast(e,1e3),setTimeout(function(){location.href=APP_ROOT+"/weixin/index.php?ctl=question&act=index&type=mine"},1e3)}).fail(function(e){$.toast(e)})})},pop_comment:function(e){i.id=e,document.getElementById("comment-info").focus(),$(".float-comment, .float-comment-mask").addClass("show"),$(".float-comment-mask").click(function(){$(".float-comment, .float-comment-mask").removeClass("show")})},send_comment:function(){if(self=this,i.answer=$.emoji2Str(i.answer),$.checkEmpty(this.answer))return $.toast("评论内容不能为空"),!1;var e={id:self.id,answer:self.answer};handleAjax.handle(APP_ROOT+"/weixin/index.php?ctl=question&act=answer",e).done(function(e){$.toast(e,1e3),setTimeout(function(){i.answer="",$(".float-comment, .float-comment-mask").removeClass("show"),$(".invest-bar").removeClass("hide"),location.reload()},1e3)}).fail(function(e){$.toast(e)})},praise:function(e,t){handleAjax.handle(APP_ROOT+"/weixin/index.php?ctl=question&act=praise",{id:e},"",1).done(function(e){e.is_praise?($(t.target).addClass("active"),i.praise_count=i.praise_count+1):($(t.target).removeClass("active"),i.praise_count>0?i.praise_count=i.praise_count-1:i.praise_count=0)}).fail(function(e){$.toast(e)})}}})}),$(document).on("pageInit","#page-question-form_question",function(e,t,n){var i=new Vue({el:"#vscope-question",data:{type:"",title:"",question:"",is_open:!0,pid:""},methods:{select_open:function(){i.is_open=!i.is_open},check:function(){var e=this;return i.title=$.emoji2Str(i.title),i.question=$.emoji2Str(i.question),empty(i.title)?($.toast("问题标题不能为空"),!1):!empty(e.question)||($.toast("问题描述不能为空"),!1)},submit:function(){if(self=this,!self.check())return!1;var e={title:self.title,question:self.question,is_open:self.is_open};handleAjax.handle(APP_ROOT+"/weixin/index.php?ctl=question&act=question",e).done(function(e){$.toast(e,1e3),setTimeout(function(){location.href=APP_ROOT+"/weixin/index.php?ctl=question&act=index&type=mine"},1e3)}).fail(function(e){$.toast(e)})},cancel:function(){history.back()}}})}),$(document).on("pageInit","#page-question-index, #page-course-yu_list",function(e,t,n){function i(){new_paramet=paramet.type?"&type="+paramet.type:"",ajax_url=APP_ROOT+"/weixin/index.php?ctl=question&act=index"+new_paramet,console.log(ajax_url)}i();var a=new Vue({el:"#vscope-paging",data:{total_page:total_page,page:page}});$(n).on("infinite",function(e){infinite_scroll(n,ajax_url,".question-list",a)}),$(n).find(".pull-to-refresh-content").on("refresh",function(e){pull_refresh(n,ajax_url,".question-list",a)}),function(){handleAjax.handle(ajax_url,"","",1).done(function(e){var t=$(".question-list").find(".view-counts"),n=e.question_list;$(t).each(function(e){$(this).html(n[e].count)})}).fail(function(e){$.toast(e)})}()}),$(document).on("pageInit","#page-question-question",function(e,t,n){var i=new Vue({el:"#vscope-question",data:{type:"",title:"",question:"",is_open:!0,pid:""},methods:{select_open:function(){i.is_open=!i.is_open},check:function(){var e=this;return!empty(e.question)||($.toast("问题描述不能为空"),!1)},submit:function(){if(self=this,!self.check())return!1;var e={type:self.type,title:self.title,question:self.question,is_open:self.is_open,pid:self.pid};handleAjax.handle(APP_ROOT+"/weixin/index.php?ctl=date&act=date",e).done(function(e){$.toast(e,1e3),setTimeout(function(){},1e3)}).fail(function(e){$.toast(e)})},cancel:function(){}}})}),$(document).on("pageInit","#page-share-add",function(e,t,n){var i=["2017年互联网大事件","2017年互联网大事件","2017年互联网大事件","2017年互联网大事件","2017年互联网大事件"];$(document).on("click",".create-actions",function(){var e=[{text:i[0],onClick:function(){$("input[name='type']").val(i[0])}},{text:i[1],onClick:function(){$("input[name='type']").val(i[1])}},{text:i[2],bold:!0,color:"danger",onClick:function(){$("input[name='type']").val(i[2])}},{text:i[3],onClick:function(){$("input[name='type']").val(i[3])}},{text:i[4],onClick:function(){$("input[name='type']").val(i[4])}},{text:i[4],onClick:function(){$("input[name='type']").val(i[4])}}],t=[e];$.actions(t)}),$(document).on("click",".modal-overlay-visible",function(){$.closeModal()});new Vue({el:"#vscope-add_share",data:{title:"",cate_id:"",content:"",imgs:""},methods:{check:function(){var e=this;return empty(e.title)?($.toast("分享标题不能为空"),!1):empty(e.cate_id)?($.toast("请选择分类"),!1):!empty(e.content)||($.toast("分享内容不能为空"),!1)},submit:function(){if(self=this,!self.check())return!1;var e={title:self.title,cate_id:self.cate_id,content:self.content,imgs:self.imgs};handleAjax.handle(APP_ROOT+"/weixin/index.php?ctl=share&act=add",e).done(function(e){$.toast(e,1e3),setTimeout(function(){},1e3)}).fail(function(e){$.toast(e)})}}})}),$(document).on("pageInit","#page-share-add_share",function(e,t,n){var i=[];$(document).on("click",".modal-overlay-visible",function(){$.closeModal()});var a=new Vue({el:"#vscope-add_share",data:{title:"",cate_id:"",cate_name:"",content:""},computed:{new_buttons:function(){for(var e=0;e<cate_list.length;e++)console.log(cate_list[e]),i[e]={text:cate_list[e].cate_name,id:cate_list[e].id,onClick:function(){a.cate_id=this.id,a.cate_name=this.text}};return i}},methods:{create_actions:function(){console.log(a.new_buttons),this.$nextTick(function(){var e=[a.new_buttons];$.actions(e)})},check:function(){var e=this;return a.title=$.emoji2Str(a.title),a.content=$.emoji2Str(a.content),empty(e.title)?($.toast("分享标题不能为空"),!1):empty(e.cate_id)?($.toast("请选择分类"),!1):!empty(e.content)||($.toast("分享内容不能为空"),!1)},submit:function(){if(self=this,!self.check())return!1;var e=JSON.stringify(imgs),t={title:self.title,cate_id:self.cate_id,content:self.content,imgs:e};handleAjax.handle(APP_ROOT+"/weixin/index.php?ctl=share&act=add",t).done(function(e){$.toast(e,1e3),setTimeout(function(){location.href=APP_ROOT+"/weixin/index.php?ctl=user_center&act=share"},1e3)}).fail(function(e){$.toast(e)})}}});get_file_more_fun("upload-imgs",5)}),$(document).on("pageInit","#page-share-detail",function(e,t,n){var i=new Vue({el:"#vscope-share_detail",data:data,methods:{pop_comment:function(e,t,n){i.type=e,i.id=t,i.reply_user_id=n,$(".footer-bar").hide(),document.getElementById("comment-info").focus(),$(".float-comment, .float-comment-mask").addClass("show"),$(".float-comment-mask").click(function(){$(".float-comment, .float-comment-mask").removeClass("show"),$(".footer-bar").show()})},send_comment:function(){var e=this,t={id:e.id,content:$("textarea[name='content']").val()};return 1==e.type&&(t.reply_user_id=e.reply_user_id),empty(t.content)?($.toast("评论内容不能为空"),!1):void handleAjax.handle(APP_ROOT+"/weixin/index.php?ctl=share&act=reply",t).done(function(e){$.toast(e,1e3),setTimeout(function(){location.reload(),i.content=""},1e3)}).fail(function(e){$.toast(e)})},praise:function(e){handleAjax.handle(APP_ROOT+"/weixin/index.php?ctl=share&act=praise",{id:e}).done(function(e){$.toast(e,1e3),setTimeout(function(){location.reload()},1e3)}).fail(function(e){$.toast(e)})},delete_reply:function(e){$.confirm("确定要删除此评论么？",function(){handleAjax.handle(APP_ROOT+"/weixin/index.php?ctl=share&act=delete_reply",{id:e}).done(function(e){$.toast(e,1e3),setTimeout(function(){location.reload()},1e3)}).fail(function(e){$.toast(e)})})},delete_share:function(e){$.confirm("删除后，您的分享所有信息都会被删除！","删除分享",function(){handleAjax.handle(APP_ROOT+"/weixin/index.php?ctl=share&act=delete",{id:e}).done(function(e){$.toast(e,1e3),setTimeout(function(){location.href=APP_ROOT+"/weixin/index.php?ctl=user_center&act=index"},1e3)}).fail(function(e){$.toast(e)})})}}});$("textarea[name='content']").on("input propertychange",function(){var e=$(this).val();$(this).val($.emoji2Str(e))})}),$(document).on("pageInit","#page-share-index",function(e,t,n){function i(){new_paramet=paramet.cate_id?"&cate_id="+paramet.cate_id:"",ajax_url=APP_ROOT+"/weixin/index.php?ctl=share&act=index"+new_paramet,console.log(ajax_url)}new Swiper(".swiper-container",{scrollbar:".swiper-scrollbar",freeMode:!0,scrollbarHide:!0,slidesPerView:"auto",spaceBetween:0,grabCursor:!0});i();var a=new Vue({el:"#vscope-paging",data:{total_page:total_page,page:page}}),o={el:"#vscope-share_index_1",data:data,methods:{pop_comment:function(e,t,n){c.type=e,c.id=t,c.reply_user_id=n,$(".footer-bar").hide(),document.getElementById("comment-info").focus(),$(".float-comment, .float-comment-mask").addClass("show"),$(".float-comment-mask").click(function(){$(".float-comment, .float-comment-mask").removeClass("show"),$(".footer-bar").show()})},praise:function(e,t){handleAjax.handle(APP_ROOT+"/weixin/index.php?ctl=share&act=praise",{id:e},"",1).done(function(n){var i,a=$(t.target),o=parseInt($("#item-praise-"+e).attr("data-praise_count"));if(o&&(i=user_nick_name+"、"),i=o?user_nick_name+"、":user_nick_name,1==n.status)if(n.is_praise)o+=1,$(a).addClass("active"),$("#praise-name-"+e).prepend(i),$("#item-praise-"+e).attr("data-praise_count",o).html(o),$("#praise-count-"+e).html(o);else{var s=$("#praise-name-"+e).html().toString();o-=1,$(a).removeClass("active"),$("#praise-name-"+e).html(s.replace(i,"")),$("#item-praise-"+e).attr("data-praise_count",o).html(o),$("#praise-count-"+e).html(o)}else $.toast(n.error)}).fail(function(e){$.toast(e)})},delete_reply:function(e){$.confirm("确定要删除此评论么？",function(){handleAjax.handle(APP_ROOT+"/weixin/index.php?ctl=share&act=delete_reply",{id:e}).done(function(e){$.toast(e,1e3),setTimeout(function(){location.reload()},1e3)}).fail(function(e){$.toast(e)})})}}},s={el:"#vscope-share_index_2",data:{content:""},methods:{send_comment:function(){var e={id:c.id,content:$("textarea[name='content']").val()};return 1==c.type&&(e.reply_user_id=c.reply_user_id),empty(e.content)?($.toast("评论内容不能为空"),!1):void handleAjax.handle(APP_ROOT+"/weixin/index.php?ctl=share&act=reply",e).done(function(e){$.toast(e,1e3),setTimeout(function(){location.reload()},1e3)}).fail(function(e){$.toast(e)})}}};$(n).on("infinite",function(e){infinite_scroll(n,ajax_url,".share-list",a,function(){new Vue(o),new Vue(s)})}),$(n).find(".pull-to-refresh-content").on("refresh",function(e){pull_refresh(n,ajax_url,".share-list",a,function(){new Vue(o),new Vue(s)})});var c=new Vue(o);new Vue(s);$("textarea[name='content']").on("input propertychange",function(){var e=$(this).val();$(this).val($.emoji2Str(e))})}),$(document).on("pageInit","#page-user_center-add_feedback",function(e,t,n){var i=new Vue({el:"#vscope-add_feedback",data:{content:""},methods:{submit:function(e){return i.content=$.emoji2Str(i.content),empty(this.content)?($.toast("评论内容不能为空"),!1):void handleAjax.handle(APP_ROOT+"/weixin/index.php?ctl=user_center&act=feedback",{content:this.content}).done(function(e){$.toast(e,1e3),setTimeout(function(){location=APP_ROOT+"/weixin/index.php?ctl=user_center&act=index"},1e3)}).fail(function(e){$.toast(e)})}}})}),$(document).on("pageInit","#page-user_center-authent",function(e,t,n){get_file_fun("upload-business_card"),get_file_fun("upload-work_card"),get_file_fun("upload-work_contract"),$("#J-save").on("click",function(){var e={business_card:$("#upload-business_card-image").attr("src"),work_card:$("#upload-work_card-image").attr("src"),work_contract:$("#upload-work_contract-image").attr("src")};return $.checkEmpty(e.business_card)?($.toast("请上传名片照片"),!1):$.checkEmpty(e.work_card)?($.toast("请上传工作牌照片"),!1):$.checkEmpty(e.work_contract)?($.toast("请上传工作合同正面"),!1):void handleAjax.handle(APP_ROOT+"/weixin/index.php?ctl=user_center&act=attestation",e).done(function(e){$.toast(e,1e3)}).fail(function(e){$.toast(e)})})}),$(document).on("pageInit","#page-user_center-balance",function(e,t,n){function i(){new_paramet=paramet.type?"&type="+paramet.type:"",ajax_url=APP_ROOT+"/weixin/index.php?ctl=user_center&act=balance"+new_paramet}i();var a=new Vue({el:"#vscope-paging",data:{total_page:total_page,page:page}});$(n).on("infinite",function(e){infinite_scroll(n,ajax_url,".trade-list",a)})}),$(document).on("pageInit","#page-user_center-index",function(){$("#vscope-checkLogin").on("click",".J-check_login",function(){handleAjax.handle(check_login_url).done(function(e){console.log(e)}).fail(function(e){$.toast(e)})})}),$(document).on("pageInit","#page-user_center-invite",function(e,t,n){$(".flex-box").on("click",".J-fx",function(){var e=$(this),t=e.attr("data-type");e.addClass("active").siblings().removeClass("active"),data.share_type=t}),$(".J-share").on("click",function(e){window.event?window.event.cancelBubble=!0:e.stopPropagation(),$(".share-tip").addClass("show")}),$("document, body").click(function(e){window.event?window.event.cancelBubble=!0:e.stopPropagation(),$(".share-tip").removeClass("show")}),wx.ready(function(){wx.onMenuShareTimeline({title:wx_desc,link:wx_link,imgUrl:wx_img,success:function(){},cancel:function(){}}),wx.onMenuShareAppMessage({title:wx_title,desc:wx_desc,link:wx_link,imgUrl:wx_img,success:function(){},cancel:function(){}}),wx.error(function(e){})})}),$(document).on("pageInit","#page-user_center-user_center",function(){get_file_fun("upload-avatar",function(){data.head_image=$("#upload-avatar-image").attr("src"),handleAjax.handle(APP_ROOT+"/weixin/index.php?ctl=user_center&act=user_save_wpk",data).done(function(e){$.toast(e,1e3)}).fail(function(e){$.toast(e)})}),$("#city").cityPicker({toolbarTemplate:'<header class="bar bar-nav">    \t\t\t\t\t\t<button class="button button-link pull-right close-picker">确定</button>    \t\t\t\t\t\t<h1 class="title">选择所在城市</h1>    \t\t\t\t\t  </header>',onClose:function(){var e=$("input[name='city']").val(),t=e.split(" ");data.province=t[0],data.city=t[1],handleAjax.handle(APP_ROOT+"/weixin/index.php?ctl=user_center&act=user_save_wpk",data).done(function(e){$.toast(e,1e3)}).fail(function(e){$.toast(e)})}}),$(document).on("click",".open-setting",function(){var e=$(this),t=e.attr("popup_type");$.popup("."+t)}),$(document).on("click",".J-setting",function(){var e=$(this),t=e.attr("data_type"),n=e.find("input[name='"+t+"']").val(),i=e.find(".item-title").html();$(".popup-"+t).find(".item-after").html(""),e.find(".item-after").append('<i class="icon iconfont">&#xe61c;</i>');for(var a in data)a==t&&(data[a]=n);handleAjax.handle(APP_ROOT+"/weixin/index.php?ctl=user_center&act=user_save_wpk",data).done(function(e){$.toast(e,1e3),setTimeout(function(){$.closeModal(),$("#text-"+t).html(i)},1e3)}).fail(function(e){$.toast(e)})}),$(document).on("click",".J-setting-text",function(){var e=$(this),t=e.attr("data_type"),n=e.attr("data_tip"),i=$(".popup-"+t).find("input[name='"+t+"']").val();if(empty(i))return $.toast(n+"不能为空"),!1;for(var a in data)a==t&&(data[a]=i);handleAjax.handle(APP_ROOT+"/weixin/index.php?ctl=user_center&act=user_save_wpk",data).done(function(e){$.toast(e,1e3),setTimeout(function(){$.closeModal(),$("#text-"+t).html(i)},1e3)}).fail(function(e){$.toast(e)})})});